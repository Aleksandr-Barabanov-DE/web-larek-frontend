# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Базовый принцип

В проекте используется архитектурный принцип MVP (Model-View-Presenter), обеспечивающий четкое разделение ответственностей между компонентами:

Model отвечает за загрузку данных по API, сохранение и работу с данными, полученными от пользователя.

View отображает интерфейс для взаимодействия с пользователем, отслеживает события и уведомляет о них.

Presenter (в данном случае EventEmitter) связывает модель данных с интерфейсом, управляя их взаимодействием при возникновении событий.

Действия в проекте следуют определенной цепочке:

V --> P --> M --> P --> V
Это означает, что действие начинается с пользовательского интерфейса (View), затем передается презентеру (Presenter), далее к модели (Model), снова к презентеру и, наконец, обратно к пользовательскому интерфейсу.

## Краткое описание основных классов.

1. Базовые классы:

Класс Api:

Выполняет запросы к API серверу.
Методы get и post отправляют GET и POST запросы соответственно.
Метод handleResponse обрабатывает ответы от сервера.

Класс EventEmitter:

Реализует паттерн "Observer/Наблюдатель", обеспечивая работу событий.
Позволяет устанавливать и снимать слушателей событий, а также вызывать их при наступлении событий.
Методы:
оn - добавляет события;
off — убирает события;
emit — вызывает событие;
onAll — подписывает на все события;
ofAll — сбрасывает все обработчики событий;
trigger — создает заданное событие с заданными аргументами.
EventEmitter используется по всему проекту для управления событиями между различными компонентами. Это позволяет создавать компоненты с низкой степенью связанности, которые могут взаимодействовать друг с другом через систему событий, повышая модульность и гибкость проекта. EventEmitter играет ключевую роль в событийно-ориентированной архитектуре проекта, предоставляя централизованный механизм для обработки событий, что способствует эффективной коммуникации между различными частями проекта.

Класс Component:

Абстрактный класс компонентов представления (Наследуется всеми классами представления View). Предназначен для создания компонентов пользовательского интерфейса.

Методы:
toggleClass - Переключение класса;
setText — Установление текстового содержимого;
setDisabled — Изменение статуса блокировки;
protected setHidden — Скрытие элемента;
setVisible — Показ элемента;
setImage — Установить изображение с альтернативным текстом;
render — рендерит компонент, используя переданные данные.

2. Компоненты Бизнес-логики.

Класс Model:

Абстрактный класс для создания модельных данных.
Методы:
emitChanges(event: string, payload?: object) — запускает событие с переданным названием и данными, уведомляя подписчиков в изменении модели

Класс LarekApi:

Получает данные с сервера и передает их. LarekAPI расширяет базовый класс Api, предоставляя специфические методы для работы с API магазина.
Наследует функциональность базового класса Api, который обеспечивает выполнение запросов к API серверу.

Методы:
getProductList - Получение списка всех продуктов с сервера.
getProductItem - Получение детальной информации о продукте по его ID.
orderProducts - Отправка информации о заказе на сервер и получение результата.

Класс BasketModel:

Управляет данными корзины товаров.
Методы:
getCounter - возвращает количество товаров в корзине.
getSumAll - считает и возвращает сумму синапсов всех товаров в корзине.
setSelectedСard - добавляет товар в корзину.
deleteCardFromBasket - удаляет товар из корзины.
clearBasket - очищает/удаляет все товары из корзины.

Класс Product
Наследуется от Model.
Этот класс разработан для создания и управления данными о продукте. Он предоставляет способ представления информации о продукте, который может использоваться для отображения или обработки в бизнес-логике.

Класс AppState
Наследуется от Model.
Класс, представляющий центральную модель для управления состоянием проекта, включает в себя данные каталога продуктов, корзину, информацию о заказах и ошибки валидации форм.
Методы:
наследует методы из Model

clearBasket - Очищает корзину и генерирует соответствующие события;
clearOrder - очищает данные заказа;
setCatalog - устанавливает каталог продуктов, преобразуя каждый элемент в экземпляр Product и инициализирует событие изменения каталога;
setPreview - устанавливает предпросомотр продукта и инициализирует событие об изменении предпросмотра;
addToBasket - добавляет товар в корзину;
removeFromBasket - удаляет товар из корзины;
updateBasket - Обновляет состояние корзины;
setDeliveryField - устанавливает значения в данные доставки, при успешной валидации инициализирует события готовности данных;
setContactField - устанавливает значения в данные контактов заказа, при успешной валидации инициализирует события готовности данных;
ValidateDelivery - проверяет значения данных доставки;
ValidateContact - проверяет значения данных контактов.

3. Компоненты Представления. Классы View:

Класс Modal

Управляет отображением модальных окон
Методы:
openModal - отображает модальное окон.
closeModal - закрывает модальное окно.
content - Задает содержимое модального окна.
render - Рендерит модальное окно с переданным содержимым и открывает его.

Класс Form

Класс, предназначенный для создания и управления формами. Обрабатывает события ввода и отправки, а также управляет состоянием валидности и отображением формы. Наследуется от Component.
Методы:
onInputChange - Обработчик событий ввода, который генерирует события изменения для каждого поля в форме.
set valid - Контролирует активность кнопки отправки в зависимости от валидности формы.
set errors - Устанавливает и отображает ошибки валидации формы.
render - Отображает состояние формы, управляя ее валидностью, обработкой ошибок и установкой значений полей.

Класс Card

Класс Card создан для отображения и управления карточками товара. Он управляет представлением информации о продукте, такой как название, описание, цена и изображение. Класс реализует интерфейс IProduct и наследуется от Component.

Методы:
disablePriceButton - проверяет цену и делает кнопку покупки неактивной если цена не указана.
set/get id - управляет индификатором карточки.
set/get title - управляет названием товара.
set/get price - управляет ценой товара.
set/get category - управляет категорией и ее цветом.
set image - устанавливает изображение товара.
set description - устанавливает описание товара.
set buttonTitle - устанавливает textContent кнопки.

Класс Basket

Управляет отображением корзины товаров.
Методы:
toggleButton - Включает или выключает кнопку оформления заказа в зависимости от наличия товаров в корзине;
set items - устанавливает товары в корзине;
set total - Устанавливает и отображает общую стоимость товаров в корзине.

Компоненты части Order (Классы View)

Класс DeliveryForm.
Наследуется от Form.

Методы:
toggleButtons - Переключает активное состояние кнопок способа оплаты;
set address - устанавливает адрес доставки.

Класс ContactForm.
Наследуется от Form
Методы:
set phone - устанавливает номер телефона;
set email - устанавливает адрес электронной почты.

Класс Success
Наследуется от Component
Методы:

set total - Этот метод устанавливает текст, который отображается в элементе \_totalElement. Он используется для обновления информации о стоимости или других данных, связанных с успешным завершением операции.
